# 텐센트 ASR 비동기 Python 확장

텐센트 클라우드 자동 음성 인식(ASR) 서비스를 위한 Python 확장으로, 실시간 음성-텍스트 변환 기능을 제공하며 완전한 비동기 아키텍처를 지원합니다.

## 기능

- **완전 비동기 지원**: 완전한 비동기 아키텍처로 구축되어 고성능 음성 인식 제공
- **실시간 스트리밍**: 낮은 지연시간의 실시간 오디오 스트리밍 지원
- **다중 종료 모드**: 설정 가능한 종료 전략(연결 해제, 음소거 패킷, 벤더 정의)
- **오디오 덤프**: 디버깅 및 분석을 위한 선택적 오디오 녹음
- **키프얼라이브 지원**: 설정 가능한 연결 키프얼라이브 메커니즘
- **오류 처리**: 포괄적인 오류 처리 및 상세한 로그 기록
- **다국어 지원**: 여러 언어 및 로케일 지원
- **설정 가능한 로그**: 디버깅을 위한 조정 가능한 로그 레벨

## 설정

확장에는 다음 설정 매개변수가 필요합니다:

### 필수 매개변수

- `app_id`: 텐센트 클라우드 ASR 애플리케이션 ID
- `secret_key`: 텐센트 클라우드 ASR 시크릿 키
- `params`: ASR 요청 매개변수(언어, 오디오 형식 등)

### 선택적 매개변수

- `finalize_mode`: 종료 전략
  - `disconnect`: 종료 후 연결 해제
  - `mute_pkg`: 음소거 패킷 전송
  - `vendor_defined`: 벤더 정의 전략 사용(기본값)
- `mute_pkg_duration_ms`: 음소거 패킷 지속 시간(기본값: 800밀리초)
- `dump`: 오디오 덤프 활성화(기본값: false)
- `dump_path`: 덤프 오디오 파일 경로
- `keep_alive_interval`: 키프얼라이브 간격(초)
- `log_level`: 로그 레벨(기본값: "INFO")

### 설정 예시

```json
{
  "app_id": "your_app_id",
  "secret_key": "your_secret_key",
  "params": {
    "language": "ko-KR",
    "format": "pcm",
    "sample_rate": 16000
  },
  "finalize_mode": "vendor_defined",
  "dump": false,
  "log_level": "INFO"
}
```

## API

확장은 `AsyncASRBaseExtension` 인터페이스를 구현하며 다음 주요 메서드를 제공합니다:

### 핵심 메서드

- `on_init()`: ASR 클라이언트 및 설정 초기화
- `start_connection()`: 텐센트 ASR 서비스에 연결 설정
- `stop_connection()`: ASR 서비스 연결 종료
- `send_audio()`: 인식을 위한 오디오 프레임 전송
- `finalize()`: 현재 인식 세션 종료

### 이벤트 핸들러

- `on_asr_start()`: ASR 세션 시작 시 호출
- `on_asr_sentence_start()`: 새 문장 시작 시 호출
- `on_asr_sentence_change()`: 문장 내용 변경 시 호출
- `on_asr_sentence_end()`: 문장 종료 시 호출
- `on_asr_complete()`: ASR 세션 완료 시 호출
- `on_asr_fail()`: ASR 실패 시 호출
- `on_asr_error()`: ASR 오류 발생 시 호출

## 의존성

- `typing_extensions`: 타입 힌트용
- `pydantic`: 설정 검증용
- `websockets`: WebSocket 통신용
- `pytest`: 테스트용(개발 의존성)

## 개발

### 빌드

확장은 TEN Framework 빌드 시스템의 일부로 빌드되며 추가 빌드 단계가 필요하지 않습니다.

### 단위 테스트

다음 명령으로 단위 테스트를 실행합니다:

```bash
pytest tests/
```

확장에는 다음 영역의 포괄적인 테스트가 포함됩니다:
- 설정 검증
- 오디오 처리
- 오류 처리
- 연결 관리

## 사용법

1. **설치**: 확장은 TEN Framework와 함께 자동으로 설치됩니다
2. **설정**: 텐센트 클라우드 ASR 인증 정보 및 매개변수 설정
3. **통합**: TEN Framework ASR 인터페이스를 통해 확장 사용
4. **모니터링**: 디버깅 및 모니터링을 위해 로그 확인

## 오류 처리

확장은 다음 방법으로 상세한 오류 정보를 제공합니다:
- 모듈 오류 코드
- 벤더별 오류 세부사항
- 포괄적인 로그 기록
- 우아한 성능 저하

## 성능

- **낮은 지연시간**: 실시간 처리에 최적화
- **높은 처리량**: 효율적인 오디오 프레임 처리
- **메모리 효율성**: 최소한의 메모리 사용량
- **연결 재사용**: 가능한 경우 지속적인 연결 유지

## 보안

- **인증 정보 암호화**: 민감한 인증 정보는 설정에서 암호화
- **안전한 통신**: 안전한 WebSocket 연결 사용
- **입력 검증**: 포괄적인 입력 검증 및 정리

## 문제 해결

### 일반적인 문제

1. **연결 실패**: app_id 및 secret_key 설정 확인
2. **오디오 품질 문제**: 오디오 형식 및 샘플링 레이트 설정 확인
3. **성능 문제**: 버퍼 설정 및 종료 모드 조정
4. **로그 문제**: 적절한 로그 레벨 설정

### 디버그 모드

설정에서 `dump: true`를 설정하여 디버그 모드를 활성화하고 분석을 위해 오디오를 녹음합니다.

## 라이선스

이 확장은 TEN Framework의 일부이며 Apache License, Version 2.0 하에서 라이선스됩니다.
